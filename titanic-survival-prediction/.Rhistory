hotelling <- hotelling.test(cbind(log_cty,sqrt_hwy)~trans2,data=d1)
library(Hotteling)
library(Hotelling)
hotelling <- hotelling.test(cbind(log_cty,sqrt_hwy)~trans2,data=d1)
hotelling
cov(d1)
cov(d1 %>% select(-trans2))
cov(d1 %>% select(as.factor(trans2),hwy,cty)
cov(d1 %>% select(as.factor(trans2),hwy,cty))
cov(d1 %>% select(as.factor(trans2),hwy,cty))
d1
levene_test(d1)
levene_test(d1,log_cty~sqrt_hwy)
levene_test(d1,trans2~sqrt_hwy)
d1 %>% group_by(trans2) %>%
levene_test(log_cty~sqrt_hwy)
head(d1)
head(pivot_longer(cols=log_cty:sqrt_hwy))
head(d1 %>% pivot_longer(cols=log_cty:sqrt_hwy))
d1 %>% pivot_longer(cols=log_cty:sqrt_hwy) %>%
group_by(name) %>%
levene_test(value~trans2)
d1 %>% pivot_longer(cols=log_cty:sqrt_hwy) %>%
group_by(name) %>%
levene_test(value~trans2)
d1 %>% pivot_longer(cols=log_cty:sqrt_hwy) %>%
group_by(name) %>%
levene_test(value~trans2)
d1 <- df2 %>%
mutate(log_cty=log(cty),sqrt_hwy=sqrt(hwy)) %>%
select(trans2,log_cty,sqrt_hwy)
d1 %>% pivot_longer(cols=log_cty:sqrt_hwy) %>%
group_by(name) %>%
levene_test(value~trans2)
head(d1)
summary(d1)
d1 %>% pivot_longer(cols=log_cty:sqrt_hwy) %>%
group_by(name) %>%
t_test(value~trans2,
var.equal=1)
d1 %>% pivot_longer(cols=log_cty:sqrt_hwy) %>%
group_by(name) %>%
t_test(value~trans2,
var.equal=1)
head(mpg)
library(tidyverse)
head(mpg)
help(mpg)
df <- mpg %>% select(trans,cty,hwy) %>%
group_by(trans)
df2 <-mpg %>%  mutate(trans2=word(trans,1,sep=fixed("("))) %>% as.data.frame() %>% group_by(trans2)
mpg %>% select(transmission=str_extract(trans, "^(auto|manual)"),mpg_city = cty,mpg_highway = hwy)
mpg %>% select(transmission=str_extract(mpg$trans, "^(auto|manual)"),mpg_city = cty,mpg_highway = hwy)
mpg %>% select(transmission=trans,mpg_city = cty,mpg_highway = hwy)
mpg %>% transmute(trans=str_extract(trans, "^(auto|manual)"))%>%  select(transmission=trans,mpg_city = cty,mpg_highway = hwy)
mpg %>% transmute(trans=str_extract(trans, "^(auto|manual)"))
mpg %>% mutate(trans=str_extract(trans, "^(auto|manual)"))%>%  select(transmission=trans,mpg_city = cty,mpg_highway = hwy)
df2 <- mpg %>% mutate(trans=str_extract(trans, "^(auto|manual)"))%>%
select(transmission=trans,mpg_city = cty,mpg_highway = hwy)
df <- mpg %>% mutate(trans=str_extract(trans, "^(auto|manual)"))%>%
select(transmission=trans,mpg_city = cty,mpg_highway = hwy)
df2 <-mpg %>%  mutate(trans2=word(trans,1,sep=fixed("("))) %>% as.data.frame() %>% group_by(trans2)
#niemoje
df2 %>% select(cty,hwy,trans2) %>%
pivot_longer(cols=cty:hwy,
names_to = 'cty_hwy',
values_to = 'mpg') %>%
ggplot(aes(x=cty_hwy,y=mpg,color=trans2))+geom_boxplot()
df2 %>% mutate(n=n()) %>%
group_by(trans2,n) %>%
summarise_at(vars(cty,hwy),
list(~mean(.),~sd(.)))
df
df %>% group_by(transmission)
df %>% summarise(n=n())
df %>% group_by(transmission) %>% summarise(n=n())
df %>% group_by(transmission) %>%
summarise(n=n(),mean(mpg_city),mean(mpg_highway), sd(mpg_city),sd(mpg_highway))
df %>% group_by(transmission) %>%
mutate(n=n()) %>%
summarise_at(vars(mpg_city,mpg_highway),
~mean(.))
df %>% group_by(transmission) %>%
mutate(n=n()) %>%
summarise_at(vars(mpg_city,mpg_highway),
~mean(.),~sd(.))
df %>% group_by(transmission) %>%
mutate(n=n()) %>%
summarise_at(vars(mpg_city,mpg_highway),
list(~mean(.),~sd(.)))
df %>% mutate(n=n()) %>%
group_by(transmission,n) %>%
summarise_at(vars(mpg_city,mpg_highway),
list(~mean(.),~sd(.)))
df <- mpg %>% mutate(trans=str_extract(trans, "^(auto|manual)"))%>%
select(transmission=trans,mpg_city = cty,mpg_highway = hwy) %>%
group_by(transmission)
df2 <-mpg %>%  mutate(trans2=word(trans,1,sep=fixed("("))) %>% as.data.frame() %>% group_by(trans2)
df2 <-mpg %>%  mutate(trans2=word(trans,1,sep=fixed("("))) %>% as.data.frame() %>% group_by(trans2)
Stworzyć podsumowanie danych, w których będzie średnia i odchylenie standardowe z podzialem na miasto/autostrade i ze wzgledu na auto/manual
```{r}
df %>% mutate(n=n()) %>%
group_by(transmission,n) %>%
summarise_at(vars(mpg_city,mpg_highway),
list(~mean(.),~sd(.)))
df2 %>% mutate(n=n()) %>%
group_by(trans2,n) %>%
summarise_at(vars(cty,hwy),
list(~mean(.),~sd(.)))
#moje
df
#moje na x- rozdzaj y-ilosc high/cty
df %>% ggplot(aes(x=transmission))+
geom_boxplot()
#moje na x- rozdzaj y-ilosc high/cty
df %>% ggplot(aes(x=transmission,y=mpg_city))+
geom_boxplot()
#moje na x- rozdzaj y-ilosc high/cty
df %>% ggplot(aes(x=transmission,y=mpg_city,fill=mpg_highway))+
geom_boxplot()
#moje na x- rozdzaj y-ilosc high/cty
df %>% ggplot(aes(x=transmission,y=c(mpg_city,mpg_highway)))+
geom_boxplot()
library(rstatix)
df2 %>% select(trans2,cty,hwy) %>%
group_split(trans2,.keep=0) %>%
map(~mshapiro_test(.x))
#moje na x- rozdzaj y-ilosc high/cty
df %>% ggplot(aes(x=transmission,color=c(mpg_city,mpg_highway)))+
geom_boxplot()
#moje na x- rozdzaj y-ilosc high/cty
df %>% pivot_longer()
#moje na x- rozdzaj y-ilosc high/cty
df %>% pivot_longer()
#moje na x- rozdzaj y-ilosc high/cty
df %>% pivot_longer(
cols = mpg_city:mpg_highway,
names_to = 'city_highway'
)
#moje na x- rozdzaj y-ilosc high/cty
df %>% pivot_longer(
cols = mpg_city:mpg_highway,
)
#moje na x- rozdzaj y-ilosc high/cty
df %>% pivot_longer(
cols = mpg_city:mpg_highway,
names_to = 'city_highway',
values_to = 'mpg')
#moje na x- rozdzaj y-ilosc high/cty
df %>% pivot_longer(
cols = mpg_city:mpg_highway,
names_to = 'city_highway',
values_to = 'mpg') %>%
ggplot(aes(x=city_highway,y=mpg))
#moje na x- rozdzaj y-ilosc high/cty
df %>% pivot_longer(
cols = mpg_city:mpg_highway,
names_to = 'city_highway',
values_to = 'mpg') %>%
ggplot(aes(x=city_highway,y=mpg))+
geom_boxplot()
#moje na x- rozdzaj y-ilosc high/cty
df %>% pivot_longer(
cols = mpg_city:mpg_highway,
names_to = 'city_highway',
values_to = 'mpg') %>%
ggplot(aes(x=city_highway,y=mpg,fill=transmission))+
geom_boxplot()
df
df %>% group_split(transmission,.keep=0)
df %>% ungroup() %>% group_split(transmission,.keep=0)
df %>% group_split(transmission,.keep=0)
df
df %>% select(mpg_city,mpg_highway)
df %>% ungroup() %>% select(mpg_city,mpg_highway)
df2 %>% select(trans2,cty,hwy) %>%
group_split(trans2,.keep=0) %>%
map(~mshapiro_test(.x))
df2 %>% select(trans2,cty,hwy) %>%
group_split(trans2,.keep=0) %>%
map(~mshapiro_test(.x))
df %>% ungroup() %>% select(mpg_city,mpg_highway)
plot(df$mpg_city)
plot(df$mpg_highway)
plot(rnorm(100))
hist(rnorm(100))
hist(df$mpg_city)
hist(df$mpg_highway)
hist(df$mpg_highway,df$mpg_city)
plot(x = df$mpg_city,y=df$mpg_highway)
df %>% ungroup() %>% select(mpg_city,mpg_highway)
df %>% ungroup() %>% select(mpg_city,mpg_highway) %>% mshapiro_test()
df %>% ungroup() %>% select(mpg_city,mpg_highway) %>% shapiro_test()
df %>% ungroup() %>% select(mpg_city,mpg_highway) %>% mshapiro_test()
df %>% group_split(transmission)
df %>% ungroup() %>% group_split(transmission)
df %>% ungroup() %>% group_split(transmission)%>% mshapiro_test()
df %>% ungroup() %>% group_split(transmission)%>% shapiro.test()
df %>% ungroup() %>% group_split(transmission)
df %>% ungroup() %>% group_split(transmission) %>% shapiro_test()
df %>% ungroup() %>% group_split(transmission) %>% map(mshapiro_test)
df %>% ungroup() %>% group_split(transmission) %>% map(mshapiro_test())
df %>% ungroup() %>% group_split(transmission) %>% map(mshapiro_test(.))
df %>% ungroup() %>% group_split(transmission) %>% map(~mshapiro_test())
df %>% ungroup() %>% group_split(transmission) %>% map(~mshapiro_test(.))
df %>% ungroup() %>% group_split(transmission) %>% map(~mshapiro_test(.x))
df %>% ungroup() %>% group_split(transmission) %>% map(~mshapiro_test(.x))
df2 %>% select(trans2,cty,hwy) %>%
group_split(trans2,.keep=0) %>%
map(~mshapiro_test(.x))
df %>% group_split(transmission) %>% map(~mshapiro_test(.x))
df %>% ungroup() %>% group_split(transmission) %>% map(~mshapiro_test(.x))
df2 <-mpg %>%  mutate(trans2=word(trans,1,sep=fixed("("))) %>% as.data.frame() %>% group_by(trans2)
df2 %>% select(trans2,cty,hwy) %>%
group_split(trans2,.keep=0) %>%
map(~mshapiro_test(.x))
df2 %>% select(trans2,cty,hwy) %>%
group_split(trans2,.keep=0)
df %>% ungroup() %>% group_split(transmission)
df %>% ungroup() %>% group_split(transmission) %>% select(mpg_city,mpg_highway) %>% map(~mshapiro_test(.x))
df %>% select(mpg_city,mpg_highway) %>% group_split(transmission) %>% map(~mshapiro_test(.x))
df %>% select(mpg_city,mpg_highway) %>% map(~mshapiro_test(.x))
df %>% select(mpg_city,mpg_highway)
df %>% select(mpg_city,mpg_highway)
df %>% select(mpg_city,mpg_highway) %>% group_split(transmission)
df %>% select(mpg_city,mpg_highway)
df
df
df %>% ungroup()
df %>% ungroup() %>% group_split(transmission)
df %>% ungroup() %>% group_split(transmission, .keep=0)
df %>% ungroup() %>% group_split(transmission, .keep=0) %>% map(~mshapiro_test(.x))
summary(car::powerTransform(cbind(df2$cty,df2$hwy)~1))
df2 %>%
mutate(log_cty=log(cty),sqrt_hwy=sqrt(hwy)) %>%
select(trans2,log_cty,sqrt_hwy) %>%
group_split(trans2,.keep=0) %>%
map(~mshapiro_test(.x))
df %>%
mutate(log_cty=log(mpg_city),sqrt_hwy=sqrt(mpg_highway)) %>%
select(transmission,log_cty,sqrt_hwy)
df %>%
mutate(log_cty=log(mpg_city),sqrt_hwy=sqrt(mpg_highway)) %>%
select(transmission,log_cty,sqrt_hwy) %>%
group_split(transmission)
df %>%
mutate(log_cty=log(mpg_city),sqrt_hwy=sqrt(mpg_highway)) %>%
select(transmission,log_cty,sqrt_hwy) %>%
group_split(transmission, .keep=0)
df %>%
mutate(log_cty=log(mpg_city),sqrt_hwy=sqrt(mpg_highway)) %>%
select(transmission,log_cty,sqrt_hwy) %>%
ungroup() %>%
group_split(transmission, .keep=0)
df %>%
mutate(log_cty=log(mpg_city),sqrt_hwy=sqrt(mpg_highway)) %>%
select(transmission,log_cty,sqrt_hwy) %>%
ungroup() %>%
group_split(transmission, .keep=0) %>%
map(~mshapiro_test(.x))
df %>%
mutate(log_cty=log(mpg_city),sqrt_hwy=sqrt(mpg_highway)) %>%
select(transmission,log_cty,sqrt_hwy) %>%
ungroup() %>%
group_split(transmission, .keep=0) %>%
map(~mshapiro_test(.x))
cov(df2 %>% select(cty,hwy))
# Chunk 1: setup
knitr::opts_chunk$set(echo = TRUE)
# Chunk 2
library(tidyverse)
head(mpg)
help(mpg)
# Chunk 3
df <- mpg %>% mutate(trans=str_extract(trans, "^(auto|manual)"))%>%
select(transmission=trans,mpg_city = cty,mpg_highway = hwy) %>%
group_by(transmission)
df2 <-mpg %>%  mutate(trans2=word(trans,1,sep=fixed("("))) %>% as.data.frame() %>% group_by(trans2)
# Chunk 4
df %>% mutate(n=n()) %>%
group_by(transmission,n) %>%
summarise_at(vars(mpg_city,mpg_highway),
list(~mean(.),~sd(.)))
df2 %>% mutate(n=n()) %>%
group_by(trans2,n) %>%
summarise_at(vars(cty,hwy),
list(~mean(.),~sd(.)))
# Chunk 5
#moje na x- rozdzaj y-ilosc high/cty
df %>% pivot_longer(
cols = mpg_city:mpg_highway,
names_to = 'city_highway',
values_to = 'mpg') %>%
ggplot(aes(x=city_highway,y=mpg,fill=transmission))+
geom_boxplot()
#niemoje
df2 %>% select(cty,hwy,trans2) %>%
pivot_longer(cols=cty:hwy,
names_to = 'cty_hwy',
values_to = 'mpg') %>%
ggplot(aes(x=cty_hwy,y=mpg,color=trans2))+geom_boxplot()
# Chunk 6
library(rstatix)
df2 %>% select(trans2,cty,hwy) %>%
group_split(trans2,.keep=0) %>%
map(~mshapiro_test(.x))
df %>% ungroup() %>% group_split(transmission, .keep=0) %>%
map(~mshapiro_test(.x))
# Chunk 7
summary(car::powerTransform(cbind(df2$cty,df2$hwy)~1))
# Chunk 8
df2 %>%
mutate(log_cty=log(cty),sqrt_hwy=sqrt(hwy)) %>%
select(trans2,log_cty,sqrt_hwy) %>%
group_split(trans2,.keep=0) %>%
map(~mshapiro_test(.x))
df %>%
mutate(log_cty=log(mpg_city),sqrt_hwy=sqrt(mpg_highway)) %>%
select(transmission,log_cty,sqrt_hwy) %>%
ungroup() %>%
group_split(transmission, .keep=0) %>%
map(~mshapiro_test(.x))
# Chunk 9
cov(df2 %>% select(cty,hwy))
cov(df2 %>% select(cty,hwy))
df
df %>% select(mpg_city, mpg_highway)
df %>% ungroup() %>% select(mpg_city, mpg_highway)
cov(df %>% ungroup() %>% select(mpg_city, mpg_highway))
df %>% group_map(
cov(.x, .keep=FALSE)
)
df %>% group_map(
cov(.x)
)
df %>% group_map(
~cov(.x)
)
box_m(df2[,c('cty','hwy')],df2[,'trans2'])
df
df$transmission
box_m(df[,c("mpg_city","mpg_highway")], df[,"transmission"])
df[,c("mpg_city","mpg_highway")]
df[,"transmission"]
df <- df %>% ungroup()
box_m(df[,c("mpg_city","mpg_highway")], df[,"transmission"])
df[,c("mpg_city","mpg_highway")]
df[,"transmission"]
df$transmission
box_m(df[,c("mpg_city","mpg_highway")], df$transmission)
df1 <- df %>%
mutate(log_cty=mpg_city,sqrt_hwy=mpg_highway) %>%
select(transmission,log_cty,sqrt_hwy)
box_m(df1[, c('log_cty','sqrt_hwy')], df1$transmission)
df1 <- df %>%
mutate(log_cty=mpg_city,sqrt_hwy=mpg_highway) %>%
select(transmission,log_cty,sqrt_hwy)
box_m(df1[, c('log_cty','sqrt_hwy')], df1$transmission)
d1 <- df2 %>%
mutate(log_cty=log(cty),sqrt_hwy=sqrt(hwy)) %>%
select(trans2,log_cty,sqrt_hwy)
box_m(d1[, c('log_cty','sqrt_hwy')],d1[,'trans2'])
box_m(d1[, c('log_cty','sqrt_hwy')],d1$'trans2')
df1 <- df %>%
mutate(log_cty=mpg_city,sqrt_hwy=mpg_highway) %>%
select(transmission,log_cty,sqrt_hwy)
box_m(df1[, c('log_cty','sqrt_hwy')], df1$transmission)
df1 <- df %>%
mutate(log_cty=log(mpg_city),sqrt_hwy=(mpg_highway)) %>%
select(transmission,log_cty,sqrt_hwy)
box_m(df1[, c('log_cty','sqrt_hwy')], df1$transmission)
library(Hotelling)
hotelling.test(cbind(log_cty,sqrt_hwy)~transmission, data=df1)
hotelling <- hotelling.test(cbind(log_cty,sqrt_hwy)~trans2,data=d1)
hotelling.test(cbind(log_cty,sqrt_hwy)~transmission, data=df1)
hotelling <- hotelling.test(cbind(log_cty,sqrt_hwy)~transmission, data=df1)
hotelling$stats
hotelling$pval
cbind(df1$log_cty,df1$sqrt_hwy)
df$transmission
df
aggregate(df[,2:3], by=list(df$transmission), mean)
means[2:3, 2:3]
# jak
means <- aggregate(df[,2:3], by=list(df$transmission), mean)
means[2:3, 2:3]
means[2:3, 1:2]
means[1:2, 2:3]
hotelling$pval
# jak
means <- aggregate(df[,2:3], by=list(df$transmission), mean)
# jak
aggregate(df[,2:3], by=list(df$transmission), mean)
df1
df1 %>% pivot_longer(
cols=log_cty:sqrt_hwy
)
df1 %>% pivot_longer(
cols=log_cty:sqrt_hwy
) %>%
group_by(name) %>%
levene_test(value~transmission)
df1 %>% pivot_longer(
cols=log_cty:sqrt_hwy
) %>%
group_by(name) %>%
levene_test(value~to.factor(transmission))
d1 %>% pivot_longer(cols=log_cty:sqrt_hwy) %>%
group_by(name) %>%
t_test(value~trans2,
var.equal=1)
df1 %>% pivot_longer(
cols=log_cty:sqrt_hwy
) %>%
group_by(name) %>%
levene_test(value~as.factor(transmission))
shapiro.test(rnorm(100))
shapiro.test(rnorm(1000))
shapiro.test(rnorm(100))
shapiro.test(rnorm(100))
shapiro.test(rnorm(100))
shapiro.test(rnorm(100))
shapiro.test(rnorm(100))
shapiro.test(rnorm(100))
shapiro.test(rnorm(100))
shapiro.test(rnorm(100))
shapiro.test(rnorm(100))
shapiro.test(rnorm(100))
shapiro.test(rnorm(100))
shapiro.test(rnorm(100))
shapiro.test(rnorm(100))
shapiro.test(rnorm(100))
shapiro.test(rnorm(100))
shapiro.test(rnorm(100))
shapiro.test(rnorm(100))
shapiro.test(rnorm(100))
d1 %>% pivot_longer(cols=log_cty:sqrt_hwy) %>%
group_by(name) %>%
t_test(value~trans2,
var.equal=1)
df1 %>% pivot_longer(cols=log_cty:sqrt_hwy) %>%
group_by(name) %>%
t_test(value~transmission,
var.equal=1)
df1 %>% pivot_longer(cols=log_cty:sqrt_hwy) %>%
group_by(name) %>%
t_test(value~transmission,
var.equal=1)
knitr::opts_chunk$set(echo = TRUE)
library(lattice)
df <- environmental
df
summary(df)
lm <- lm(df$ozone~df$temperature)
summary(lm)
plot(lm)
plot(df$ozone,df$temperature,lm)
lm$coefficients
abline(lm$coefficients)
plot(df$ozone,df$temperature)
abline(lm$coefficients)
plot(df$temperature,df$ozone)
abline(lm$coefficients)
```{r}
plot(df$temperature,df$ozone)
abline(lm$coefficients)
abline(lm$coefficients, color=red)
abline(lm$coefficients, color="red")
plot(df$temperature,df$ozone)
abline(lm$coefficients, color="red")
plot(df$temperature,df$ozone)
abline(lm$coefficients, col="red")
summary(fit1)
fit1 <- lm(df$ozone~df$temperature)
summary(fit1)
plot(df$temperature,df$ozone)
abline(fit1$coefficients, col="red")
predict(fit1, 0)
predict(fit1, newdata = c(0))
predict(fit1, newdata = list(0))
newdata <- data.frame(x = 0)
predict(model, newdata)
newdata <- data.frame(x = 0)
predict(fit1, newdata)
newdata <- data.frame(x = 2)
predict(fit1, newdata)
predict.lm(fit1, newdata)
fit2 <- lm(df$ozone~df$temperature)
summary(fit2)
plot(df$temperature,df$ozone)
abline(fit2$coefficients, col="red")
fit2 <- lm(df$ozone~df$temperature - 1)
summary(fit2)
plot(df$temperature,df$ozone)
abline(fit2$coefficients, col="red")
abline(fit2$coefficients,0, col="red")
fit2 <- lm(df$ozone~df$temperature - 1)
summary(fit2)
plot(df$temperature,df$ozone)
abline(fit2$coefficients,0, col="red")
fit2 <- lm(df$ozone~df$temperature - 1)
summary(fit2)
plot(df$temperature,df$ozone)
abline(0,fit2$coefficients, col="red")
nyc_squirrels <- readr::read_csv("https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-10-29/nyc_squirrels.csv")
nyc_squirrels %>% length()
library(tidyverse)
nyc_squirrels %>% length()
nyc_squirrels %>% dim()
View(nyc_squirrels)
View(nyc_squirrels)
setwd("C:/Users/Dell/Desktop/projects/data-analysis/titanic-survival-prediction")
